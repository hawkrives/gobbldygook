import test from 'ava'
import convertStudent from '../convert-imported-student'

import sample from './_support/sample-student'

const getCourse = () => Promise.resolve({error: true})

test.failing('converts a student from the imported data to a Gobbldygook student', async t => {
	const actual = await convertStudent(sample, getCourse)
	const expected = {
		'id': 'da42d72c-ac71-48bf-8df7-6f4da1a7bd1e',
		'name': 'Student M. Name',
		'version': '3.0.0-beta4',
		'creditsNeeded': 35,
		'matriculation': 2012,
		'graduation': 2016,
		'advisor': 'Advisor, Name O.',
		'dateLastModified': '2016-01-01T17:03:27.011Z',
		'dateCreated': '2016-01-01T17:03:27.011Z',
		'studies': [
			{'name': 'Bachelor of Arts', 'type': 'degree', 'revision': 'latest'},
			{'name': 'Computer Science', 'type': 'major', 'revision': 'latest'},
			{'name': 'Asian Studies', 'type': 'major', 'revision': 'latest'},
			{'name': 'Japan Studies', 'type': 'concentration', 'revision': 'latest'},
		],
		'schedules': {
			'27cb6d96-4662-4106-91ce-eca37dc5226e': {
				'id': '27cb6d96-4662-4106-91ce-eca37dc5226e',
				'active': true,
				'index': 1,
				'title': 'Schedule 0',
				'clbids': [87891, 81526],
				'year': 2011,
				'semester': 9,
			},
			'fb7c49a7-7394-406b-b638-32755ddb6de4': {
				'id': 'fb7c49a7-7394-406b-b638-32755ddb6de4',
				'active': true,
				'index': 1,
				'title': 'Schedule G',
				'clbids': [82908, 83505, 82768, 82771, 82792],
				'year': 2012,
				'semester': 1,
			},
			'56397d69-0add-4631-b352-61ed778c38ad': {
				'id': '56397d69-0add-4631-b352-61ed778c38ad',
				'active': true,
				'index': 1,
				'title': 'Schedule I',
				'clbids': [85898],
				'year': 2012,
				'semester': 2,
			},
			'1ade1786-0151-44b9-b6de-a73620a0ac0f': {
				'id': '1ade1786-0151-44b9-b6de-a73620a0ac0f',
				'active': true,
				'index': 1,
				'title': 'Schedule S',
				'clbids': [84513, 84461, 85991, 85992, 84378, 84381],
				'year': 2012,
				'semester': 3,
			},
			'ca04b0cf-aa9b-4c71-8312-a021c81802cf': {
				'id': 'ca04b0cf-aa9b-4c71-8312-a021c81802cf',
				'active': true,
				'index': 1,
				'title': 'Schedule 3',
				'clbids': [89090, 88273, 88630, 88593, 88681, 88682],
				'year': 2013,
				'semester': 1,
			},
			'a7a61309-02c9-4a60-af9b-ac39941b6c94': {
				'id': 'a7a61309-02c9-4a60-af9b-ac39941b6c94',
				'active': true,
				'index': 1,
				'title': 'Schedule Z',
				'clbids': [89466],
				'year': 2013,
				'semester': 2,
			},
			'a0e5668c-8b0a-4489-859c-42337c0fcc78': {
				'id': 'a0e5668c-8b0a-4489-859c-42337c0fcc78',
				'active': true,
				'index': 1,
				'title': 'Schedule T',
				'clbids': [90719, 89957, 90339, 90340, 90172],
				'year': 2013,
				'semester': 3,
			},
			'd351f0ca-f8ca-480a-b6cf-e82a4e7c1d2e': {
				'id': 'd351f0ca-f8ca-480a-b6cf-e82a4e7c1d2e',
				'active': true,
				'index': 1,
				'title': 'Schedule L',
				'clbids': [97217, 97413, 97120, 97119, 97125],
				'year': 2014,
				'semester': 1,
			},
			'2a663761-e7e6-416b-a73d-eda4d6562161': {
				'id': '2a663761-e7e6-416b-a73d-eda4d6562161',
				'active': true,
				'index': 1,
				'title': 'Schedule W',
				'clbids': [99351],
				'year': 2014,
				'semester': 2,
			},
			'868fc315-4ee2-4dc3-b51b-b4ca81746437': {
				'id': '868fc315-4ee2-4dc3-b51b-b4ca81746437',
				'active': true,
				'index': 1,
				'title': 'Schedule 5',
				'clbids': [97582, 97407, 95594, 95842, 97333],
				'year': 2014,
				'semester': 3,
			},
			'c5c050fa-e15a-48cc-a18a-5b2936e7deb0': {
				'id': 'c5c050fa-e15a-48cc-a18a-5b2936e7deb0',
				'active': true,
				'index': 1,
				'title': 'Schedule G',
				'clbids': [102748, 100423, 100346, 103276, 99504],
				'year': 2015,
				'semester': 1,
			},
			'6280b31e-e95e-4fd0-bb86-022687be7fe7': {
				'id': '6280b31e-e95e-4fd0-bb86-022687be7fe7',
				'active': true,
				'index': 1,
				'title': 'Schedule D',
				'clbids': [101017, 101018],
				'year': 2015,
				'semester': 2,
			},
			'673c7bc8-a631-4338-a49d-544a512fcac0': {
				'id': '673c7bc8-a631-4338-a49d-544a512fcac0',
				'active': true,
				'index': 1,
				'title': 'Schedule O',
				'clbids': [103314, 103404, 104968, 102075, 103170, 103157],
				'year': 2015,
				'semester': 3,
			},
		},
		'overrides': {},
		'fabrications': {},
		'settings': {},
	}
	t.deepEqual(actual, expected)
})
